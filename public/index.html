<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">

    <script src="https://cdn.jsdelivr.net/npm/danfojs@1.2.0/lib/bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>     
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
    <script src="src/channels.js" defer></script>
    <script src="src/utils.js" defer></script>
    <script src="src/discplot.js" defer></script>
    <script src="src/boostplot.js" defer></script>
    <script src="src/download_section.js" defer></script>
    <script src="src/input_conditions.js" defer></script>
    <script src="src/server_communication.js" defer></script>
    <script src="src/noise_plot.js"  defer></script>

    <title>Simulation</title>
</head>
<body class="prevent-select" style="display: grid; grid-auto-flow: column;">
    <div style="padding: 50px; width: 1300px; box-sizing: border-box;">
        <div style="position: relative; display: inline-block; width: 100%;">
            <canvas class="window-style" style="background-color: white; position: relative; width: 100%; box-sizing: border-box;" height="400px" width="1150px" id="Graph"></canvas>
        
            <div style="position: absolute; top: 20px; right: 20px; padding: 10px; width: 135px;" class="window-style">
                <h4 style="margin: 10px 0;">Graph Settings</h4>
                <input type="checkbox" name="graph_pos_chkbx" id="graph_pos_chkbx" onclick="ax.load_to_memory();ax.draw();">
                <label for="graph_pos_chkbx">Positions</label><br>
                <input type="checkbox" name="graph_dist_chkbx" id="graph_dist_chkbx" onclick="ax.load_to_memory();ax.draw()">
                <label for="graph_dist_chkbx">Distances</label>
            </div>
        </div>
            

        <div style="display: flex; flex-direction: row; justify-content: space-between;margin-top: 50px; height: 350px; width: 100%;  box-sizing: border-box;">

            <div class="disc_params window-style">
                <div style="display: flex; justify-content: space-around; width: 100%;">
                    <div style="display: flex; flex-direction: column;text-align: center; align-content: center;">
                        <h3 for="mirror_checkbox">mirror</h3>
                        <input type="checkbox" class="mirror_checkbox" id="mirror_checkbox" onclick="ax.send_settings_to_backend();ax.draw()">
                    </div>
                    <div style="text-align: center;">
                        <h3>total disccount</h3>
                        <div class="counter">
                            <button style="border-radius: 8px 0px 0px 8px;" id = "counter_minus" onclick="element = document.getElementById('counter_txt_id'); if (element.value>0){element.value = parseInt(element.value)-1; ax.delete_discs()}; ax.send_settings_to_backend();synch_graphtoinput()">-</button>
                            <input type="text" id="counter_txt_id" value="0" onchange="element = document.getElementById('counter_txt_id'); if (element.value<0){element.value=0}else if (isNaN(element.value)){element.value=0}else {element.value=Math.round(element.value)}; if(element.value>ax.discs.length){ax.add_disc(element.value-ax.discs.length);}else{ax.delete_discs(ax.discs.length-element.value)}; ax.correct_overlap(true); ax.send_settings_to_backend();">
                            <button style="border-radius: 0px 8px 8px 0px;" id = "counter_plus" onclick="element = document.getElementById('counter_txt_id'); if (element.value<30){element.value = parseInt(element.value)+1; ax.add_disc();ax.correct_overlap()}; ax.send_settings_to_backend();">+</button>
                        </div>
                    </div>
                </div>
                
                <h3 id="scheibenauswahl" style="margin-bottom: 0; margin-top: 30px;"></h3>

                <div style="position: relative; display: flex; justify-content: space-evenly; margin: 0 0 20px 0px; width: 100%;" id="multi_input">
                    <div height="100px" style="display: flex; justify-content: center; align-items: center; flex-direction: column; justify-content: flex-end;">
                        <div class="pos_dis_input" style="margin-bottom: 18px; position: relative; display: flex; border: 1px rgb(0, 0, 0) solid; border-radius: 5px; font-weight: bold;">
                            <label id="pos_input_chbx" style="border-radius: 4px 0 0 4px;background-color: rgba(53, 134, 53, 0.82);" onclick="pos_chkbx()">pos</label>
                            <label id="dis_input_chbx" style="border-radius: 0 4px 4px 0;" onclick="dis_chkbx()">dis</label>
                        </div>

                        <div style="display:flex; width: 100px; height: 40px; flex-direction: row-reverse; background-color: white; text-align: center; border: 2px black solid; border-radius: 10px; box-sizing: border-box;">
                            <label class="unit_label" for="pos">cm</label>
                            <input class="textinput_unit" type="text" id="pos" onchange="element = document.getElementById('pos'); if (element.value>1000){element.value=1000}; if (element.value<0){element.value=0}; if (isNaN(element.value)){element.value=0}; resize_font(element); synch_inputtograph(); ax.load_to_memory();">
                        </div>
                    </div>
                    <div >
                        <h4 style="text-align: center;">thickness</h4>
                        <div style="position: relative;display:flex; width: 100px; height: 40px; flex-direction: row-reverse; background-color: white; text-align: center; border: 2px black solid; border-radius: 10px; box-sizing: border-box;">
                            <label class="unit_label" for="width">cm</label>
                            <input class="textinput_unit" type="text" id="width" onchange="element = document.getElementById('width'); if (element.value>100){element.value=100}; if (element.value<0){element.value=0}; if (isNaN(element.value)){element.value=0}; resize_font(element); synch_inputtograph(); ax.load_to_memory();">
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; flex-direction: column;">
                        <h4 style="text-align: center;">&epsilon;</h4>
                        <div style="position: relative;display:flex; width: 60px; height: 40px; flex-direction: row-reverse; background-color: white; text-align: center; border: 2px black solid; border-radius: 10px; box-sizing: border-box;">
                            <input class="textinput_unit" type="text" id="dielectric" maxlength="3" onchange="element = document.getElementById('dielectric'); if (element.value<0 || isNaN(element.value)){element.value=0}; synch_inputtograph(); ax.load_to_memory();">
                        </div>
                    </div>
                </div>
                <button class="button" style="background-color: rgb(229, 126, 126); margin-bottom: 20px;" onclick="ax.delete_fdiscs(); ax.send_settings_to_backend()">delete</button>
            </div>

            <div class="download_form">
                <div style="display: flex;flex-direction: column; justify-content: space-around; padding:20px;" class="window-style">
                    <button class="button" onclick="getElementById('input_select').click()">CSV Upload</button>  
                    <input style="display: none;" id="input_select" class="button" type="file" accept=".csv">
                    <button class="button" style="margin-top: 20px;" onclick="load_example()">Example</button>  
                </div>
                <div style="display: inline-block; padding: 20px;" class="window-style">
                    <input type="checkbox" id="radio_all" name="all" onclick="if(getElementById('radio_all').checked){getElementById('radio_pos').checked = true; getElementById('radio_width').checked = true; getElementById('radio_dielectric').checked = true;};">
                    <label for="radio_all">All</label> <br>
                    <input type="checkbox" id="radio_pos" name="position" onclick="if(!getElementById('radio_pos').checked){getElementById('radio_all').checked = false}">
                    <label for="radio_pos">Positions</label> <br>
                    <input type="checkbox" id="radio_width" name="width" onclick="if(!getElementById('radio_width').checked){getElementById('radio_all').checked = false}">
                    <label for="radio_width">Width</label><br>
                    <input type="checkbox" id="radio_dielectric" name="width" onclick="if(!getElementById('radio_dielectric').checked){getElementById('radio_all').checked = false}">
                    <label for="radio_width">Dielectric</label> <br>
                    <button class="button" style="margin-top: 20px; margin-bottom: 0;" onclick="data_export([getElementById('radio_pos').checked,getElementById('radio_width').checked,getElementById('radio_dielectric').checked])" type="submit">Export</button>  
                </div>
            </div>
            <div class="noise_window window-style" style="position: relative; width: 500px;">
                <div class="noise_settings_btn" id="noise_settings_btn">
                    <input type="checkbox" name="noise_settings_chkbx" id="noise_settings_chkbx">
                    <svg height="35px" viewBox="0 -960 960 960" fill="#1f1f1f"><path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"/></svg>
                </div>
                
                
                <h3 style="display: flex; margin: 5px 0 5px 0; height: 45px; align-items: center;justify-content: center;">Noise</h3>
                <div id="noise_plot">
                    <button class="button" style="position: absolute; top: 5px; left: 15px; height: 45px; width: 120px;" onclick="ax.send_settings_to_backend('Noise')">calculate</button>

                </div>
                <div id="noise_settings" style="position: absolute; left: 0px; width: 100%; justify-content: center; align-items: center;">
                    <div style="display: flex; justify-content: center;">
                        <div class="noise_settings_input">
                            <h4>l_taper</h4>
                            <input type="text" class="textinput" id="l_taper">
                        </div>
                        <div class="noise_settings_input">
                            <h4>attenuation</h4>
                            <input type="text" class="textinput" id="attenuation">
                        </div>
                        <div class="noise_settings_input">
                            <h4>radius</h4>
                            <input type="text" class="textinput" id="radius">
                        </div>
                        
                    </div>

                    <!-- <div style="display: inline-flex;">
                        <label for="short_delay">short_delay</label>
                        <input type="text" name="short_delay" style="width: 50px;">
                        <label for="open_delay"></label>
                        <input type="text" name="open_delay"style="width: 50px;">
                        <label for="booster_delay"></label>
                        <input type="text" name="booster_delay"style="width: 50px; ">
                    </div>
                     -->
                    <div style="display: flex; justify-content: center;">
                        <div class="noise_settings_input">
                            <h4>lna_short_delay</h4>
                            <input type="text" class="textinput" id="lna_short_delay">
                        </div>
                        <div class="noise_settings_input">
                            <h4>lna_open_delay</h4>
                            <input type="text" class="textinput" id="lna_open_delay">
                        </div>
                        <div class="noise_settings_input">
                            <h4>lna_booster_delay</h4>
                            <input type="text" class="textinput" id="lna_booster_delay">
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: center;">
                        <div class="noise_settings_input">
                            <h4>V_noise</h4>
                            <input type="text" class="textinput" id="V_noise">
                        </div>
                        <div class="noise_settings_input">
                            <h4>l_noise</h4>
                            <input type="text" class="textinput" id="l_noise">
                        </div>
                        <div class="noise_settings_input">
                            <h4>corr_mag</h4>
                            <input type="text" class="textinput" id="corr_mag">
                        </div>
                        <div class="noise_settings_input">
                            <h4>corr_phi</h4>
                            <input type="text" class="textinput" id="corr_phi">
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>

    
    <div style="position: relative; margin-right: 60px; display: flex; flex-direction: column; background-color: white;" class="window-style">
        <h2 style="text-align: center; margin-bottom: 0px;">Boostfactorcurve</h2>
        <div id="boost_plot" style="position: relative;align-self: center; background-color: white;">
            <div style="display: flex;position: absolute; top: 10px; left: 40px;" >
                <label for="scale_checkbox_1" style="margin-right: 10px;">lin</label>
                <input type="checkbox" class="scale_checkbox after_blue" id="scale_checkbox_1" onclick="update_log_lin_1(); ax.load_to_memory(); ax.send_settings_to_backend();ax.draw()">      
                <label for="scale_checkbox_1" style="margin-left: 10px;">log</label>
            </div>
            <div style="display: flex;position: absolute; top: 10px; right: 40px;" >
                <label for="scale_checkbox_2" style="margin-right: 10px;">lin</label>
                <input type="checkbox" class="scale_checkbox after_red" id="scale_checkbox_2" onclick="update_log_lin_2(); ax.load_to_memory(); ax.send_settings_to_backend();ax.draw()">
                <label for="scale_checkbox_2" style="margin-left: 10px;">log</label>
            </div>
        </div>
        <div style="display: flex; justify-content: space-around; margin: 0 60px; padding-bottom: 20px;" class="window-style">
            <div>
                <h4 style="text-align: center;">frequency range [GHz]</h4>
                <div style="display: flex; justify-content: center; align-items: center;">
                    <input type="text" id="freq_min" class="textinput" onchange="control_freq_condition();ax.send_settings_to_backend(); ax.load_to_memory();" placeholder="f_min">
                    <h2 style="margin: 0 10px;">-</h2>
                    <input type="text" id="freq_max" class="textinput" onchange="control_freq_condition();ax.send_settings_to_backend(); ax.load_to_memory();" placeholder="f_max">
                </div>
            </div>
            <div style="display: flex; flex-direction: column; align-items: center;">
                <h4 style="text-align: center;">
                    \( \tan(\delta) \cdot 10^{-6} \)
                </h4>
                <input type="text" id="tan_delta" class="textinput" style="width: 60px;" maxlength="5" onchange="control_tand_condition(); ax.send_settings_to_backend(); ax.load_to_memory();">
            </div>
        </div>

        <div id="alert_div" style="display: flex; justify-content: center; background-color: red; margin-top: 10px;"></div>
        <div style="margin-bottom: 20px;">
            <h4 style="display: flex; justify-content: center;">resolution</h4>
            <input type="range" id="slider_resolution" min="5" max="1000" onchange="ax.send_settings_to_backend(); ax.load_to_memory();" style="width: 80%; margin: 0 10%;">
        </div>
    </div>
    

    
</body>
</html>
